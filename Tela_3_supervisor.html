<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supervisor - EmbraPac</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="login-modal">
        <div class="login-box">
            <img src="img/logo-embrapac.jpeg" alt="Logo Embrapac" style="height: 60px; margin-bottom: 20px;">
            <h3 style="color: var(--primary-blue);">Acesso Restrito</h3>
            <p style="color: #666; margin-bottom: 20px;">Área exclusiva para Supervisores.</p>
            <input type="password" id="admin-pass" class="input-std" placeholder="Senha (admin)" autofocus>
            <button class="btn-action btn-blue" onclick="attemptLogin()">
                <i class="fas fa-sign-in-alt"></i> ENTRAR
            </button>
            <br>
            <a href="index.html" style="color: #999; font-size: 0.9rem; text-decoration: none;">
                <i class="fas fa-arrow-left"></i> Voltar para Operação
            </a>
        </div>
    </div>

    <header>
        <div class="logo-container">
            <img src="img/logo-embrapac.jpeg" alt="Logo Embrapac" class="logo-img">
            <span>Módulo de Supervisão</span>
        </div>
        <nav>
            <a href="index.html">Painel Operação</a>
            <a href="historico.html">Histórico</a>
            <a href="supervisor.html" class="active"><i class="fas fa-lock"></i> Supervisor</a>
        </nav>
        <div class="user-info">
            <i class="fas fa-user-tie"></i> Olá, Sr. Carlos (Supervisor) | <a href="index.html" style="color: var(--accent-yellow)">Sair</a>
        </div>
    </header>
    

        <main class="dashboard-grid"> <div class="col-stack">
            
            <div class="card">
                <h2><i class="fas fa-traffic-light"></i> STATUS DA LINHA</h2>
                <div id="status-display" class="status-badge status-stopped">
                    PARADO
                </div>
            </div>

            <div class="card supervisor-card">
                <h2><i class="fas fa-clock"></i> GESTÃO DE TURNO</h2>
                
                <div style="margin-bottom: 15px;">
                    <p style="margin:5px 0;"><strong>Turno:</strong> <span id="shift-status" style="color: #7f8c8d;">AGUARDANDO</span></p>
                    <p id="shift-time" style="font-size: 0.85rem; color:#999;">--:--</p>
                    
                    <button id="btn-start-shift" class="btn-action btn-green" onclick="toggleTurno(true)" style="padding: 8px;">
                        <i class="fas fa-play"></i> Iniciar Turno
                    </button>

                    <div id="active-shift-controls" style="display: none;">
                        <button class="btn-action btn-red" onclick="toggleTurno(false)" style="padding: 8px;">
                            <i class="fas fa-stop"></i> Encerrar Turno
                        </button>
                    </div>
                    
                    <button id="btn-export" class="btn-action btn-blue" onclick="exportarRelatorio()" style="display: none; padding: 12px;">
                        <i class="fas fa-file-csv"></i> ENVIAR RELATÓRIO
                    </button>
                </div>
            </div>

        </div>

        <div class="col-stack">
            
            <div class="card supervisor-card">
                <h2><i class="fas fa-chart-line"></i> KPIs DA LINHA (TEMPO REAL)</h2>
                <div class="kpi-grid">
                    <div class="kpi-box">
                        <div class="kpi-val" id="kpi-oee">0%</div>
                        <div class="kpi-label">OEE Global</div>
                    </div>
                    <div class="kpi-box">
                        <div class="kpi-val" id="kpi-production">0</div>
                        <div class="kpi-label">Produção (Turno)</div>
                    </div>
                    <div class="kpi-box">
                        <div class="kpi-val" id="kpi-refugo" style="color: var(--danger-color);">0.0%</div>
                        <div class="kpi-label">Taxa de Refugo</div>
                    </div>
                    <div class="kpi-box">
                        <div class="kpi-val" id="kpi-downtime">00:00</div>
                        <div class="kpi-label">Tempo Parado</div>
                    </div>
                </div>
                <p style="font-size: 0.75rem; color: #999; margin-top: 15px; text-align: right;">
                    <i class="fas fa-wifi"></i> Conexão IoT: Estável
                </p>
            </div>

        </div>

        <div class="col-stack">
            
            <div class="card">
                <h2><i class="fas fa-cogs"></i> CONTROLE MANUAL</h2>
                
                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <button id="btn-man-start" class="btn-action btn-disabled" onclick="startLine()" disabled style="flex: 1; margin: 0;">
                        <i class="fas fa-play"></i> INICIAR
                    </button>
                    <button id="btn-man-stop" class="btn-action btn-disabled" onclick="stopLine()" disabled style="flex: 1; margin: 0;">
                        <i class="fas fa-stop"></i> PARAR
                    </button>
                </div>
                
                <button id="btn-refugo" class="btn-action btn-disabled" onclick="registrarRefugo()" disabled style="margin-top: 15px;">
                    <i class="fas fa-trash-alt"></i> APONTAR REFUGO (+1)
                </button>
            </div>

            <div class="card supervisor-card">
                <h2><i class="fas fa-sliders-h"></i> PARÂMETROS DA LINHA</h2>
                
                <label style="font-weight: bold; font-size: 0.9rem; display:block; text-align:left; margin-top:10px;">Meta de Produção (un):</label>
                <input type="number" id="meta-input" class="input-std" 
                       value="100" min="0" step="1" 
                       oninput="validarNumero(this); atualizarKPIs()">
                
                <label style="font-weight: bold; font-size: 0.9rem; display:block; text-align:left;">Tempo de Ciclo (s):</label>
                <input type="number" id="ciclo-input" class="input-std" 
                       value="1" min="1" max="60" step="1" 
                       oninput="validarCiclo(this)" onchange="atualizarVelocidade()">
                
                <button id="btn-save-params" class="btn-action btn-blue" onclick="salvarParametros()" style="margin-top: 20px;">
                    <i class="fas fa-save"></i> SALVAR ALTERAÇÕES
                </button>
            </div>

        </div>

    </main>

    <div id="alarm-panel">
        <div class="alarm-text">
            <i class="fas fa-exclamation-triangle fa-2x"></i>
            <div>
                <span id="alarm-msg">FALHA CRÍTICA DETECTADA</span><br>
                <small id="alarm-time" style="opacity: 0.8;">--:--</small>
            </div>
        </div>
        <button id="btn-reset" class="btn-ack" onclick="resetarFalhas()">
            <i class="fas fa-wrench"></i> RESETAR FALHAS DA LINHA
        </button>
    </div>

    <div class="dev-tools">
        <button onclick="simularFalha()">[DEV] Simular Falha</button>
    </div>

    <script src="supervisor.js"></script>
</body>
</html>